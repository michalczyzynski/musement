<?xml version="1.0" encoding="utf-8"?>
<container
        xmlns="http://symfony.com/schema/dic/services"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://symfony.com/schema/dic/services http://symfony.com/schema/dic/services/services-1.0.xsd"
>

    <parameters>
        <parameter key="musement.sdk.base_url">https://api.musement.com</parameter> <!-- @todo Move to env -->
        <parameter key="musement.site.base_url">https://www.musement.com/</parameter> <!-- @todo Move to env -->
        <parameter key="sitemap.priority.city" type="string">0.7</parameter>
        <parameter key="sitemap.priority.activity" type="string">0.5</parameter>
    </parameters>

    <services>
        <service id="musement.application.musement.cities_and_activities_sitemap" class="Musement\Application\Musement\Sitemap\CitiesAndActivitiesSitemap">
            <argument type="service" id="musement.application.musement.fetch_cities_and_activities"/>
            <argument type="string">%musement.site.base_url%</argument>
            <argument type="string">%sitemap.priority.city%</argument>
            <argument type="string">%sitemap.priority.activity%</argument>
        </service>

        <service id="musement.application.musement.fetch_cities_and_activities" class="Musement\Application\Musement\CitiesAndActivities\FetchCitiesAndActivities">
            <argument type="service" id="musement.sdk.musement"/>
        </service>

        <service id="musement.sdk.musement" class="Musement\SDK\Musement\HttpSDK">
            <argument type="service" id="musement.sdk.musement.http.client"/>
            <argument type="service" id="musement.sdk.musement.http.request_factory"/>
            <argument type="service" id="musement.sdk.musement.http.api_map"/>
            <argument type="service" id="musement.sdk.musement.http.cities_factory" />
            <argument type="service" id="musement.sdk.musement.http.activities_factory" />
            <argument type="service" id="monolog.logger"/>
        </service>

        <service id="musement.sdk.musement.http.client" alias="psr18.http_client"/>
        <service id="musement.sdk.musement.http.request_factory" alias="nyholm.psr7.psr17_factory"/>
        <service id="musement.sdk.musement.http.api_map" class="Musement\SDK\Musement\HttpSDK\V3\ApiMap">
            <argument type="service">
                <service class="Musement\SDK\Musement\HttpSDK\Url">
                    <argument type="string">%musement.sdk.base_url%</argument>
                </service>
            </argument>
        </service>
        <service id="musement.sdk.musement.http.cities_factory" class="Musement\SDK\Musement\HttpSDK\V3\CitiesFactory" />
        <service id="musement.sdk.musement.http.activities_factory" class="Musement\SDK\Musement\HttpSDK\V3\ActivitiesFactory" />

    </services>
</container>
